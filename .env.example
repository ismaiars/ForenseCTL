# ForenseCTL - Variables de Entorno
# Copiar a .env y configurar según el entorno

# === CONFIGURACIÓN BÁSICA ===
FORENSECTL_ENV=development
FORENSECTL_LOG_LEVEL=INFO
FORENSECTL_WORK_DIR=/opt/forensectl/cases
FORENSECTL_ORGANIZATION="Tu Organización DFIR"
FORENSECTL_TIMEZONE=UTC

# === CONFIGURACIÓN DE HERRAMIENTAS ===
# Volatility3
VOLATILITY3_PATH=/opt/volatility3
VOLATILITY3_PLUGINS_PATH=/opt/volatility3/volatility3/plugins

# The Sleuth Kit
TSK_PATH=/usr/bin
TSK_TOOLS_PATH=/usr/bin

# plaso/log2timeline
PLASO_PATH=/usr/bin
PLASO_DATA_PATH=/usr/share/plaso

# YARA
YARA_RULES_PATH=./rules/yara
YARA_COMPILED_RULES_PATH=./rules/yara/compiled

# === BASE DE DATOS ===
# PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=forensectl
POSTGRES_USER=forensectl
POSTGRES_PASSWORD=forensectl123
POSTGRES_URL=postgresql://forensectl:forensectl123@localhost:5432/forensectl

# === CACHE Y COLAS ===
# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=forensectl123
REDIS_URL=redis://localhost:6379/0

# Celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# === ALMACENAMIENTO ===
# MinIO (S3-compatible)
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=forensectl
MINIO_SECRET_KEY=forensectl123
MINIO_SECURE=false
MINIO_BUCKET_EVIDENCE=forensectl-evidence
MINIO_BUCKET_REPORTS=forensectl-reports

# AWS S3 (opcional)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_S3_BUCKET_EVIDENCE=
AWS_S3_BUCKET_REPORTS=

# === SEGURIDAD ===
# Claves de cifrado (generar con: openssl rand -hex 32)
FORENSECTL_SECRET_KEY=your-secret-key-here-32-chars-minimum
FORENSECTL_ENCRYPTION_KEY=your-encryption-key-here-32-chars

# JWT para API
JWT_SECRET_KEY=your-jwt-secret-key-here
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# Firmas digitales (minisign)
MINISIGN_PRIVATE_KEY_PATH=./keys/minisign.key
MINISIGN_PUBLIC_KEY_PATH=./keys/minisign.pub

# === MONITOREO ===
# Grafana
GRAFANA_PASSWORD=forensectl123
GRAFANA_URL=http://localhost:3000

# Prometheus
PROMETHEUS_URL=http://localhost:9090

# === SERVICIOS EXTERNOS ===
# VirusTotal API
VIRUSTOTAL_API_KEY=

# Hybrid Analysis API
HYBRID_ANALYSIS_API_KEY=

# MISP
MISP_URL=
MISP_API_KEY=
MISP_VERIFY_CERT=true

# === NOTIFICACIONES ===
# Email (SMTP)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_TLS=true
SMTP_FROM_EMAIL=forensectl@tu-org.com

# Slack
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#forensics

# Microsoft Teams
TEAMS_WEBHOOK_URL=

# === CONFIGURACIÓN DE ANÁLISIS ===
# Límites de recursos
MAX_MEMORY_ANALYSIS_SIZE_GB=32
MAX_DISK_ANALYSIS_SIZE_GB=500
MAX_CONCURRENT_ANALYSES=2
ANALYSIS_TIMEOUT_HOURS=24

# Configuración de timeline
TIMELINE_MAX_EVENTS=1000000
TIMELINE_CHUNK_SIZE=10000

# Configuración YARA
YARA_MAX_FILE_SIZE_MB=100
YARA_SCAN_TIMEOUT_SECONDS=300
YARA_MAX_MATCHES=1000

# === RETENCIÓN Y LIMPIEZA ===
# Políticas de retención
RETENTION_CASES_DAYS=90
RETENTION_LOGS_DAYS=30
RETENTION_TEMP_FILES_HOURS=24

# Limpieza automática
AUTO_CLEANUP_ENABLED=true
AUTO_CLEANUP_SCHEDULE="0 2 * * *"  # Diario a las 2 AM

# === DESARROLLO ===
# Debug
DEBUG=false
DEBUG_SQL=false
DEBUG_CELERY=false

# Testing
TEST_DATABASE_URL=postgresql://forensectl:forensectl123@localhost:5432/forensectl_test
TEST_REDIS_URL=redis://localhost:6379/1

# === JUPYTER (OPCIONAL) ===
JUPYTER_TOKEN=forensectl123
JUPYTER_PASSWORD=

# === ELASTICSEARCH (OPCIONAL) ===
ELASTICSEARCH_URL=http://localhost:9200
ELASTICSEARCH_INDEX_PREFIX=forensectl
KIBANA_URL=http://localhost:5601

# === CLOUD PROVIDERS (OPCIONAL) ===
# Google Cloud
GOOGLE_APPLICATION_CREDENTIALS=
GCP_PROJECT_ID=
GCP_STORAGE_BUCKET=

# Azure
AZURE_STORAGE_ACCOUNT=
AZURE_STORAGE_KEY=
AZURE_CONTAINER_NAME=

# === CONFIGURACIÓN AVANZADA ===
# Proxy
HTTP_PROXY=
HTTPS_PROXY=
NO_PROXY=localhost,127.0.0.1

# Localización
LANGUAGE=es
LOCALE=es_ES.UTF-8

# Configuración de workers
WORKER_CONCURRENCY=2
WORKER_MAX_TASKS_PER_CHILD=1000
WORKER_PREFETCH_MULTIPLIER=1

# === MÉTRICAS Y TELEMETRÍA ===
# Habilitar métricas
METRICS_ENABLED=true
METRICS_PORT=8001

# Telemetría (opcional)
TELEMETRY_ENABLED=false
TELEMETRY_ENDPOINT=

# === CONFIGURACIÓN DE REPORTES ===
# Plantillas
REPORT_TEMPLATES_PATH=./forensectl/reports/templates
REPORT_OUTPUT_PATH=./cases

# Herramientas de conversión
PANDOC_PATH=/usr/bin/pandoc
WKHTMLTOPDF_PATH=/usr/bin/wkhtmltopdf
WEASYPRINT_ENABLED=true

# === CONFIGURACIÓN DE CASOS ===
# Nomenclatura
CASE_ID_PREFIX=CASE
CASE_ID_FORMAT="{prefix}-{date}-{org}-{incident}"

# Estructura de directorios
CASE_EVIDENCE_DIR=evidence
CASE_ANALYSIS_DIR=analysis
CASE_REPORTS_DIR=reports
CASE_MANIFESTS_DIR=manifests
CASE_CHAIN_DIR=chain

# === CONFIGURACIÓN LEGAL ===
# Información de la organización
ORG_NAME="Tu Organización"
ORG_ADDRESS="Dirección de tu organización"
ORG_PHONE="+1-234-567-8900"
ORG_EMAIL="legal@tu-org.com"

# Configuración de cadena de custodia
CHAIN_OF_CUSTODY_REQUIRED=true
DIGITAL_SIGNATURES_REQUIRED=false
EVIDENCE_ENCRYPTION_REQUIRED=false

# === CONFIGURACIÓN DE LOGGING ===
# Nivel de logs por módulo
LOG_LEVEL_CORE=INFO
LOG_LEVEL_ANALYSIS=INFO
LOG_LEVEL_REPORTS=INFO
LOG_LEVEL_API=INFO
LOG_LEVEL_CELERY=INFO

# Formato de logs
LOG_FORMAT=json
LOG_TIMESTAMP_FORMAT=iso

# Rotación de logs
LOG_ROTATION_SIZE=100MB
LOG_ROTATION_COUNT=10

# === CONFIGURACIÓN DE API ===
# API REST
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_TIMEOUT=300

# CORS
CORS_ORIGINS=["http://localhost:3000", "http://localhost:8080"]
CORS_METHODS=["GET", "POST", "PUT", "DELETE"]

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=3600

# === CONFIGURACIÓN DE DASHBOARD ===
# Dashboard web
DASHBOARD_HOST=0.0.0.0
DASHBOARD_PORT=8080
DASHBOARD_SECRET_KEY=your-dashboard-secret-key

# Autenticación
AUTH_ENABLED=false
AUTH_PROVIDER=local
AUTH_LDAP_URL=
AUTH_LDAP_BIND_DN=
AUTH_LDAP_BIND_PASSWORD=